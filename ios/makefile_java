.SUFFIXES: .java .m

BUILD_DIR = KTUtils
SOURCE_DIR = java

# Change to where distribution was unzipped.
J2OBJC_DISTRIBUTION = /usr/share/j2objc
J2OBJC = $(J2OBJC_DISTRIBUTION)/j2objc
J2OBJCC = $(J2OBJC_DISTRIBUTION)/j2objcc

OBJECTS = \
  $(BUILD_DIR)/URLEncoder.o \
  $(BUILD_DIR)/URLDecoder.o
OBJC_SOURCES = $(OBJECTS:.o=.m)
RESULT = build/idvkey-lib

default: translate $(OBJECTS)
		$(J2OBJCC) -o $(RESULT) $(OBJECTS)

translate: $(BUILD_DIR) $(OBJC_SOURCES)

clean:
		@rm -rf $(RESULT) $(BUILD_DIR)

$(BUILD_DIR)/%.m $(BUILD_DIR)/%.h: $(SOURCE_DIR)/%.java
		$(J2OBJC) -use-arc --prefix com.kloudtek.util=KTUtils -sourcepath $(SOURCE_DIR) -d $(BUILD_DIR) $?

$(BUILD_DIR)/%.o: $(BUILD_DIR)/%.m
		$(J2OBJCC) -I$(BUILD_DIR) -c $? -o $@

$(BUILD_DIR):
		@mkdir -p $(BUILD_DIR)